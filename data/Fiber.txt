SELECT DISTINCT 
   S.BANDWIDTH_CODE,
   CAST(F.POSITION AS INT),
   CS.HAS_CHILD,
   F.SOURCE AS FiberSource,
   CS.I_SOURCE AS NetworkSource,
   CASE
       WHEN F.ASSIGNMENT_STATUS IS NULL THEN 'ASSIGNABLE'
       ELSE F.ASSIGNMENT_STATUS
       END ASSIGNMENT_STATUS,
   S.UCUST as Cust,
   CS.PORT_TYPE as Port,
   CS.PRODUCT_FAMILY as family
FROM FIBER F WITH (NOLOCK)
   LEFT OUTER JOIN CIIT_STAGING CS WITH (NOLOCK) ON (CS.CONSUMABLE_TP_EID = F.A_CONSUMABLE_TP_EID
            OR
         CS.CONSUMABLE_TP_EID = F.Z_CONSUMABLE_TP_EID )
   LEFT OUTER JOIN SERVICE_LOOKUP_MVW S WITH (NOLOCK) ON CS.CIRCUIT_ID = S.SID 
WHERE upper(f.cap_id) = '00073990'
            AND
         F.CABLE_NAME = '(264) 00073990.00073991.001'
            AND
         upper(f.buffer_color) = 'BL' 
ORDER BY CAST(F.POSITION AS INT),
   F.MARKET_NAME,
   F.CAP_ID,
   F.CABLE_NAME,
   F.BUFFER_COLOR,
   CS.CIRCUIT_ID